<!DOCTYPE html>
<html lang="en" data-color-scheme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyFlow - Focus & Productivity Timer</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyBqC7W9C4C4C4C4C4C4C4C4C4C4C4C4C4C",
            authDomain: "studyflow-demo.firebaseapp.com",
            projectId: "studyflow-demo",
            storageBucket: "studyflow-demo.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890abcdef"
        };
        
        window.firebaseApp = initializeApp(firebaseConfig);
        window.firebaseAuth = getAuth();
        window.firebaseDb = getFirestore();
    </script>
    
    <!-- Spotify Web Playback SDK -->
    <script src="https://sdk.scdn.co/spotify-player.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Authentication Modal -->
        <div class="modal hidden" id="authModal">
            <div class="modal-content auth-modal">
                <div class="auth-header">
                    <h2 id="authTitle">Welcome to StudyFlow</h2>
                    <p id="authSubtitle">Sign in to sync your progress across devices</p>
                </div>
                <div class="auth-body">
                    <div class="auth-tabs">
                        <button class="auth-tab active" data-tab="signin">Sign In</button>
                        <button class="auth-tab" data-tab="signup">Sign Up</button>
                    </div>
                    
                    <form class="auth-form" id="authForm">
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="authEmail" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Password</label>
                            <input type="password" class="form-control" id="authPassword" required>
                        </div>
                        <div class="form-group confirm-password-group hidden">
                            <label class="form-label">Confirm Password</label>
                            <input type="password" class="form-control" id="authConfirmPassword">
                        </div>
                        <button type="submit" class="btn btn--primary btn--full-width" id="authSubmit">Sign In</button>
                        <div class="auth-error hidden" id="authError"></div>
                    </form>
                    
                    <div class="auth-divider">
                        <span>or</span>
                    </div>
                    
                    <button class="btn btn--outline btn--full-width" id="googleSignIn">
                        üîç Continue with Google
                    </button>
                    
                    <div class="auth-links">
                        <a href="#" id="forgotPassword">Forgot password?</a>
                        <span>|</span>
                        <a href="#" id="continueOffline">Continue offline</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="app-title">StudyFlow</h1>
                    <div class="focus-score">
                        <span class="focus-label">Focus Score:</span>
                        <span class="focus-value" id="focusScore">0</span>
                    </div>
                    <div class="sync-status" id="syncStatus">
                        <span class="sync-indicator offline">‚óè</span>
                        <span class="sync-text">Offline</span>
                    </div>
                </div>
                <div class="mode-selector">
                    <button class="mode-btn active" data-mode="pomodoro" title="Classic 25-minute focus blocks">Pomodoro</button>
                    <button class="mode-btn" data-mode="deepWork" title="Extended 90-minute deep focus sessions">Deep Work</button>
                    <button class="mode-btn" data-mode="ultradian" title="Natural 120-minute attention cycles">Ultradian</button>
                    <button class="mode-btn" data-mode="flowState" title="Extended flow state sessions">Flow State</button>
                    <button class="mode-btn" data-mode="custom" title="Customizable session lengths">Custom</button>
                </div>
                <div class="header-controls">
                    <button class="btn btn--secondary btn--sm" id="ideasToggle">üí° Ideas</button>
                    <button class="btn btn--secondary btn--sm" id="statsBtn">üìä Stats</button>
                    <button class="btn btn--secondary btn--sm" id="settingsBtn">‚öôÔ∏è Settings</button>
                    <div class="user-menu" id="userMenu">
                        <button class="btn btn--outline btn--sm" id="userMenuBtn">üë§ Account</button>
                        <div class="user-dropdown hidden" id="userDropdown">
                            <div class="user-info" id="userInfo">
                                <span class="user-email" id="userEmail">offline@studyflow.com</span>
                            </div>
                            <button class="dropdown-item" id="signOutBtn">Sign Out</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel: Ambient Sound Controls -->
            <div class="ambient-panel">
                <div class="panel-header">
                    <h3>üéµ Ambient Sounds</h3>
                    <div class="master-volume">
                        <label class="form-label">Master</label>
                        <input type="range" class="volume-slider" id="masterVolume" min="0" max="100" value="70">
                    </div>
                </div>
                
                <div class="sound-sources">
                    <div class="sound-source" data-sound="rain">
                        <div class="sound-header">
                            <span class="sound-name">üåßÔ∏è Rain</span>
                            <button class="sound-toggle" data-sound="rain">‚ñ∂Ô∏è</button>
                        </div>
                        <input type="range" class="volume-slider" data-sound="rain" min="0" max="100" value="0">
                    </div>
                    
                    <div class="sound-source" data-sound="forest">
                        <div class="sound-header">
                            <span class="sound-name">üå≤ Forest</span>
                            <button class="sound-toggle" data-sound="forest">‚ñ∂Ô∏è</button>
                        </div>
                        <input type="range" class="volume-slider" data-sound="forest" min="0" max="100" value="0">
                    </div>
                    
                    <div class="sound-source" data-sound="cafe">
                        <div class="sound-header">
                            <span class="sound-name">‚òï Caf√©</span>
                            <button class="sound-toggle" data-sound="cafe">‚ñ∂Ô∏è</button>
                        </div>
                        <input type="range" class="volume-slider" data-sound="cafe" min="0" max="100" value="0">
                    </div>
                    
                    <div class="sound-source" data-sound="ocean">
                        <div class="sound-header">
                            <span class="sound-name">üåä Ocean</span>
                            <button class="sound-toggle" data-sound="ocean">‚ñ∂Ô∏è</button>
                        </div>
                        <input type="range" class="volume-slider" data-sound="ocean" min="0" max="100" value="0">
                    </div>
                    
                    <div class="sound-source" data-sound="brownNoise">
                        <div class="sound-header">
                            <span class="sound-name">üìª Brown Noise</span>
                            <button class="sound-toggle" data-sound="brownNoise">‚ñ∂Ô∏è</button>
                        </div>
                        <input type="range" class="volume-slider" data-sound="brownNoise" min="0" max="100" value="0">
                    </div>
                    
                    <div class="sound-source" data-sound="whiteNoise">
                        <div class="sound-header">
                            <span class="sound-name">‚ö™ White Noise</span>
                            <button class="sound-toggle" data-sound="whiteNoise">‚ñ∂Ô∏è</button>
                        </div>
                        <input type="range" class="volume-slider" data-sound="whiteNoise" min="0" max="100" value="0">
                    </div>
                </div>
                
                <div class="audio-presets">
                    <label class="form-label">Audio Presets</label>
                    <select class="form-control" id="audioPresets">
                        <option value="">Custom Mix</option>
                        <option value="pure-focus">Pure Focus</option>
                        <option value="nature-study">Nature Study</option>
                        <option value="cafe-vibes">Caf√© Vibes</option>
                        <option value="deep-work">Deep Work</option>
                        <option value="creative-flow">Creative Flow</option>
                    </select>
                </div>
                
                <div class="audio-visualizer" id="audioVisualizer">
                    <canvas id="visualizerCanvas" width="300" height="80"></canvas>
                </div>
            </div>

            <!-- Timer Section -->
            <div class="timer-section">
                <div class="timer-display">
                    <div class="session-indicator">
                        <span id="sessionType">Study Session</span>
                        <span id="sessionCount">Session 1</span>
                    </div>
                    <div class="timer-circle">
                        <svg class="timer-svg" width="320" height="320">
                            <circle cx="160" cy="160" r="140" class="timer-track"></circle>
                            <circle cx="160" cy="160" r="140" class="timer-progress" id="timerProgress"></circle>
                        </svg>
                        <div class="timer-text">
                            <div class="timer-time" id="timerDisplay">25:00</div>
                            <div class="timer-label" id="timerLabel">Ready to start</div>
                        </div>
                    </div>
                    <div class="timer-controls">
                        <button class="btn btn--primary btn--lg" id="startBtn">‚ñ∂Ô∏è Start</button>
                        <button class="btn btn--secondary" id="pauseBtn">‚è∏Ô∏è Pause</button>
                        <button class="btn btn--outline" id="stopBtn">‚èπÔ∏è Stop</button>
                    </div>
                </div>
            </div>

            <!-- Tasks Section -->
            <div class="tasks-section">
                <div class="tasks-header">
                    <h2>Tasks</h2>
                    <div class="task-stats">
                        <span id="completedTasks">0</span>/<span id="totalTasks">0</span> completed
                    </div>
                </div>
                <div class="task-input-container">
                    <input type="text" class="form-control" id="taskInput" placeholder="Add a new task...">
                    <button class="btn btn--primary" id="addTaskBtn">Add</button>
                </div>
                <div class="tasks-list" id="tasksList">
                    <!-- Tasks will be dynamically added here -->
                </div>
            </div>
        </main>

        <!-- Spotify Player -->
        <div class="spotify-player" id="spotifyPlayer">
            <div class="spotify-auth hidden" id="spotifyAuth">
                <button class="btn btn--primary" id="connectSpotify">üéµ Connect Spotify</button>
            </div>
            
            <div class="spotify-controls hidden" id="spotifyControls">
                <div class="now-playing" id="nowPlaying">
                    <div class="track-info">
                        <img class="album-art" id="albumArt" src="" alt="Album">
                        <div class="track-details">
                            <div class="track-name" id="trackName">No track playing</div>
                            <div class="artist-name" id="artistName">Connect Spotify to start</div>
                        </div>
                    </div>
                    <div class="playback-controls">
                        <button class="control-btn" id="prevBtn">‚èÆÔ∏è</button>
                        <button class="control-btn primary" id="playPauseBtn">‚ñ∂Ô∏è</button>
                        <button class="control-btn" id="nextBtn">‚è≠Ô∏è</button>
                    </div>
                    <div class="volume-control">
                        <span>üîä</span>
                        <input type="range" class="volume-slider" id="spotifyVolume" min="0" max="100" value="50">
                    </div>
                </div>
                
                <div class="spotify-search hidden" id="spotifySearch">
                    <input type="text" class="form-control" id="searchInput" placeholder="Search tracks, artists, playlists...">
                    <div class="search-results" id="searchResults"></div>
                </div>
                
                <div class="focus-playlists">
                    <label class="form-label">Focus Playlists</label>
                    <select class="form-control" id="focusPlaylistSelect">
                        <option value="">Select a playlist</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Ideas Panel -->
        <div class="ideas-panel hidden" id="ideasPanel">
            <div class="ideas-header">
                <h3>üí° Quick Ideas</h3>
                <button class="ideas-close" id="ideasClose">√ó</button>
            </div>
            <div class="ideas-content">
                <div class="idea-input-container">
                    <textarea class="form-control" id="ideaInput" placeholder="Capture your idea quickly..." rows="2"></textarea>
                    <div class="idea-controls">
                        <select class="form-control idea-category" id="ideaCategory">
                            <option value="study">üìö Study Ideas</option>
                            <option value="task">‚úÖ Tasks</option>
                            <option value="insight">üí° Insights</option>
                            <option value="question">‚ùì Questions</option>
                            <option value="creative">üé® Creative</option>
                            <option value="research">üîç Research</option>
                        </select>
                        <button class="btn btn--primary btn--sm" id="addIdeaBtn">Save</button>
                        <button class="btn btn--secondary btn--sm" id="voiceIdeaBtn">üé§</button>
                    </div>
                </div>
                
                <div class="ideas-filters">
                    <input type="text" class="form-control" id="ideasSearch" placeholder="Search ideas...">
                    <select class="form-control" id="ideasFilter">
                        <option value="all">All Categories</option>
                        <option value="study">Study Ideas</option>
                        <option value="task">Tasks</option>
                        <option value="insight">Insights</option>
                        <option value="question">Questions</option>
                        <option value="creative">Creative</option>
                        <option value="research">Research</option>
                    </select>
                </div>
                
                <div class="ideas-list" id="ideasList">
                    <!-- Ideas will be dynamically added here -->
                </div>
                
                <div class="ideas-footer">
                    <button class="btn btn--outline btn--sm" id="exportIdeasBtn">üìÑ Export</button>
                    <button class="btn btn--secondary btn--sm" id="clearIdeasBtn">üóëÔ∏è Clear All</button>
                </div>
            </div>
        </div>

        <!-- Footer Stats -->
        <footer class="footer-stats">
            <div class="stat-item">
                <span class="stat-label">Today's Study Time</span>
                <span class="stat-value" id="todayStudyTime">0h 0m</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Current Streak</span>
                <span class="stat-value" id="currentStreak">0 days</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Tasks Completed</span>
                <span class="stat-value" id="todayTasks">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Ideas Captured</span>
                <span class="stat-value" id="todayIdeas">0</span>
            </div>
        </footer>
    </div>

    <!-- Statistics Modal -->
    <div class="modal hidden" id="statsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Statistics & Achievements</h2>
                <button class="modal-close" id="closeStatsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Study Time</h3>
                        <p class="stat-number" id="totalStudyTime">0h 0m</p>
                    </div>
                    <div class="stat-card">
                        <h3>Sessions Completed</h3>
                        <p class="stat-number" id="totalSessions">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Tasks Completed</h3>
                        <p class="stat-number" id="totalTasksCompleted">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Best Streak</h3>
                        <p class="stat-number" id="bestStreak">0 days</p>
                    </div>
                </div>
                
                <div class="achievements-section">
                    <h3>Achievements</h3>
                    <div class="achievements-grid" id="achievementsGrid">
                        <!-- Achievements will be rendered here -->
                    </div>
                </div>
                
                <div class="export-section">
                    <button class="btn btn--primary" id="exportStatsBtn">üìÑ Export CSV</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal hidden" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="closeSettingsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-group">
                    <h3>Timer Settings</h3>
                    <div class="settings-row">
                        <label class="form-label">Custom Study Duration (minutes)</label>
                        <input type="number" class="form-control" id="customStudyTime" min="1" max="180" value="60">
                    </div>
                    <div class="settings-row">
                        <label class="form-label">Custom Break Duration (minutes)</label>
                        <input type="number" class="form-control" id="customBreakTime" min="1" max="60" value="10">
                    </div>
                </div>
                
                <div class="settings-group">
                    <h3>Audio & Music</h3>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="autoMusicBreaks" checked>
                            Auto-pause music during breaks
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="ambientMixMode" checked>
                            Mix ambient sounds with music
                        </label>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h3>Wellness & Focus</h3>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="eyeReminders" checked>
                            Eye strain reminders (20-20-20 rule)
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="postureReminders" checked>
                            Posture check reminders
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="hydrationReminders" checked>
                            Hydration reminders
                        </label>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h3>Preferences</h3>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="soundEnabled" checked>
                            Enable notification sounds
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="autoStartBreaks" checked>
                            Auto-start break sessions
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="distractionFreeMode">
                            Distraction-free mode during focus
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Break Activities Modal -->
    <div class="modal hidden" id="breakModal">
        <div class="modal-content">
            <div class="modal-body text-center">
                <h2>üéâ Great Work!</h2>
                <p class="break-message" id="breakMessage">Time for a well-deserved break.</p>
                <div class="break-timer">
                    <div class="break-time" id="breakTimeDisplay">5:00</div>
                    <p>Break time remaining</p>
                </div>
                
                <div class="break-activities">
                    <h3>Suggested Break Activity:</h3>
                    <div class="break-activity" id="breakActivity">
                        <div class="activity-title" id="activityTitle">Take a Deep Breath</div>
                        <div class="activity-desc" id="activityDesc">Practice 4-7-8 breathing technique</div>
                        <div class="activity-duration" id="activityDuration">60 seconds</div>
                    </div>
                </div>
                
                <div class="break-controls">
                    <button class="btn btn--outline" id="skipBreakBtn">Skip Break</button>
                    <button class="btn btn--primary" id="nextActivityBtn">Next Activity</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Achievement Banner -->
    <div class="achievement-banner hidden" id="achievementBanner">
        <div class="achievement-content">
            <span class="achievement-icon">üèÜ</span>
            <div class="achievement-text">
                <div class="achievement-title" id="achievementTitle">Achievement Unlocked!</div>
                <div class="achievement-desc" id="achievementDesc">You've earned a new badge!</div>
            </div>
        </div>
    </div>

    <!-- Notification System -->
    <div class="notification-container" id="notificationContainer"></div>

    <script src="app.js"></script>
</body>
</html>